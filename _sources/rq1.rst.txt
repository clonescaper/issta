
RQ1
#############

Can Clonescaper bypass the latest ML-based clone detectors with the proposed code transformations?

we answer RQ1, the eï¬€ectiveness of Clonescaper on bypassing the ML-based clone detectors. This evaluation is conducted on three state-of-the-art detectors, ASTNN, FCDetector, and TBCCD, which are the representatives of the latest advances in applying ML techniques to clone detection. 

Astnn
--------- 
`Github <https://github.com/clonescaper/CLONESCAPER/tree/main/RQ1-mlDetectorsResult/astnn>`_

The clone pairs with test code ids greater than 52000 in astnn are clone pairs composed of equivalent transformations generated by our tool. The ids less than 52000 are the data in the original paper, so we only need to count the ids greater than 52000.

All Mutation
^^^^^^^^^^^^^^^
total:10300 Pairs

+-----------------+----------------------+----------------------+----------------------+--------------+ 
| correct: type:1 | test1_id: 3908       | test2_id: 27099      | true: 0              | predicted: 0 |              
+-----------------+----------------------+----------------------+----------------------+--------------+ 
| correct: type:1 | test1_id: 1790408760 | test2_id: 1790408761 | true: 1              | predicted: 1 |              
+-----------------+----------------------+----------------------+----------------------+--------------+ 
| error  : type:1 | test1_id: 1600307910 | test2_id: 1600307911 | true: 1              | predicted: 0 |
+-----------------+----------------------+----------------------+----------------------+--------------+ 

92.30% of the clones were unrecognizable to astnn.


Random Mutation 
^^^^^^^^^^^^^^^
total 10394*5 
If the ids are equal after dividing by 100, it means it is obtained by mutating the equal code snippet.
1854418100,1854418110,1854418120,1854418130,1854418140 are the equal code snippet.

All 5 could not escape astnn detection and failed to escape.

+-----------------+----------------------+----------------------+---------+--------------+
| correct: type:1 | test1_id: 1854418100 | test2_id: 1854418101 | true: 1 | predicted: 1 |
+-----------------+----------------------+----------------------+---------+--------------+
| correct: type:1 | test1_id: 1854418110 | test2_id: 1854418111 | true: 1 | predicted: 1 |
+-----------------+----------------------+----------------------+---------+--------------+
| correct: type:1 | test1_id: 1854418120 | test2_id: 1854418121 | true: 1 | predicted: 1 |
+-----------------+----------------------+----------------------+---------+--------------+
| correct: type:1 | test1_id: 1854418140 | test2_id: 1854418141 | true: 1 | predicted: 1 |
+-----------------+----------------------+----------------------+---------+--------------+
| correct: type:1 | test1_id: 1854418130 | test2_id: 1854418131 | true: 1 | predicted: 1 |
+-----------------+----------------------+----------------------+---------+--------------+

As long as one of the five cannot be detected as a successful escape.

+-----------------+----------------------+----------------------+----------------------+--------------+ 
| correct: type:1 | test1_id: 1281443600 | test2_id: 1281443601 | true: 1              | predicted: 1 |              
+-----------------+----------------------+----------------------+----------------------+--------------+ 
| correct: type:1 | test1_id: 1281443610 | test2_id: 1281443611 | true: 1              | predicted: 1 |              
+-----------------+----------------------+----------------------+----------------------+--------------+ 
| error : type:1  | test1_id: 1281443620 | test2_id: 1281443621 | true: 1              | predicted: 0 |
+-----------------+----------------------+----------------------+----------------------+--------------+ 
| correct: type:1 | test1_id: 1281443630 | test2_id: 1281443631 | true: 1              | predicted: 1 |              
+-----------------+----------------------+----------------------+----------------------+--------------+ 
| correct: type:1 | test1_id: 1281443640 | test2_id: 1281443641 | true: 1              | predicted: 1 |              
+-----------------+----------------------+----------------------+----------------------+--------------+ 







Genetic Algorithm
^^^^^^^^^^^^^^^^^^^^
It is similar to the Random Mutation.


MCMC
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
It is similar to the Random Mutation.


FCDetector
--------- 
`Github <https://github.com/clonescaper/CLONESCAPER/tree/main/RQ1-mlDetectorsResult/FCDector>`_

Since some of the data cannot be processed in the data pre-processing phase of this tool, the total number of clone pairs generated will be less than the clone pairs we provide.



All Mutation
^^^^^^^^^^^^^^^
result example 

+------------+--------------+----------------+----------------+
| pred_cur:1 | traget_cur:1 | ite/535/180610 | ite/535/180611 |
+------------+--------------+----------------+----------------+
| pred_cur:0 | traget_cur:1 | ite/571/367460 | ite/571/367461 |
+------------+--------------+----------------+----------------+


Random Mutation 
^^^^^^^^^^^^^^^
If the ids are equal after dividing by 100, it means it is obtained by mutating the equal code snippet.
1368100,1368110,1368120,1368130,1368140 are the equal code snippet.

All 5 could not escape FCDetector detection and failed to escape.

+------------+--------------+---------------+---------------+
| pred_cur:1 | traget_cur:1 | m/627/1368100 | m/627/1368101 |
+------------+--------------+---------------+---------------+
| pred_cur:1 | traget_cur:1 | m/627/1368110 | m/627/1368111 |
+------------+--------------+---------------+---------------+
| pred_cur:1 | traget_cur:1 | m/627/1368120 | m/627/1368121 |
+------------+--------------+---------------+---------------+
| pred_cur:1 | traget_cur:1 | m/627/1368130 | m/627/1368131 |
+------------+--------------+---------------+---------------+
| pred_cur:1 | traget_cur:1 | m/627/1368140 | m/627/1368141 |
+------------+--------------+---------------+---------------+

As long as one of the five cannot be detected as a successful escape.

+------------+--------------+---------------+---------------+
| pred_cur:0 | traget_cur:1 | m/680/4145600 | m/680/4145601 |
+------------+--------------+---------------+---------------+
| pred_cur:0 | traget_cur:1 | m/680/4145610 | m/680/4145611 |
+------------+--------------+---------------+---------------+
| pred_cur:0 | traget_cur:1 | m/680/4145620 | m/680/4145621 |
+------------+--------------+---------------+---------------+
| pred_cur:1 | traget_cur:1 | m/680/4145630 | m/680/4145631 |
+------------+--------------+---------------+---------------+
| pred_cur:0 | traget_cur:1 | m/680/4145640 | m/680/4145641 |
+------------+--------------+---------------+---------------+


Genetic Algorithm
^^^^^^^^^^^^^^^^^^^^
It is similar to the Random Mutation.

MCMC
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
It is similar to the Random Mutation.

TBCCD
--------- 
`Github <https://github.com/clonescaper/CLONESCAPER/tree/main/RQ1-mlDetectorsResult/TBCCD>`_


All Mutation
^^^^^^^^^^^^^^^
The trained model is used to test the clone pairs we provide. Since it is a deterministic transformation, there is only one clone pair per code fragment, so the final escape rate = 1-recall.



Random Mutation 
^^^^^^^^^^^^^^^
If the ids are equal after dividing by 100, it means it is obtained by mutating the equal code snippet.
160310,160311,160312,160313,160314 are the equal code snippet.

All 5 could not escape TBCCD detection and failed to escape.

+------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+---------------+
| correct: 1 | predict: 1 clone_paris: ['./paper_data/TBCCDS/TBCCD1/TestDate/ProgramsDump/160310.c', './paper_data/TBCCDS/TBCCD1/TestDate/ProgramsMutate/160310.c', '1'] | m/680/4145600 | m/680/4145601 |
+------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+---------------+
| correct: 1 | predict: 1 clone_paris: ['./paper_data/TBCCDS/TBCCD1/TestDate/ProgramsDump/160311.c', './paper_data/TBCCDS/TBCCD1/TestDate/ProgramsMutate/160311.c', '1'] | m/680/4145610 | m/680/4145611 |
+------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+---------------+
| correct: 1 | predict: 1 clone_paris: ['./paper_data/TBCCDS/TBCCD1/TestDate/ProgramsDump/160312.c', './paper_data/TBCCDS/TBCCD1/TestDate/ProgramsMutate/160312.c', '1'] | m/680/4145620 | m/680/4145621 |
+------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+---------------+
| correct: 1 | predict: 1 clone_paris: ['./paper_data/TBCCDS/TBCCD1/TestDate/ProgramsDump/160313.c', './paper_data/TBCCDS/TBCCD1/TestDate/ProgramsMutate/160313.c', '1'] | m/680/4145630 | m/680/4145631 |
+------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+---------------+
| correct: 1 | predict: 1 clone_paris: ['./paper_data/TBCCDS/TBCCD1/TestDate/ProgramsDump/160314.c', './paper_data/TBCCDS/TBCCD1/TestDate/ProgramsMutate/160314.c', '1'] | m/680/4145640 | m/680/4145641 |
+------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+---------------+

As long as one of the five cannot be detected as a successful escape.

+------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+---------------+
| correct: 1 | predict: 1 clone_paris: ['./paper_data/TBCCDS/TBCCD1/TestDate/ProgramsDump/160360.c', './paper_data/TBCCDS/TBCCD1/TestDate/ProgramsMutate/160360.c', '1']  | m/680/4145600 | m/680/4145601 |
+------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+---------------+
| correct: 1 | predict: 1 clone_paris: ['./paper_data/TBCCDS/TBCCD1/TestDate/ProgramsDump/160361.c', './paper_data/TBCCDS/TBCCD1/TestDate/ProgramsMutate/160361.c', '1']  | m/680/4145610 | m/680/4145611 |
+------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+---------------+
| correct: 1 | predict: -1 clone_paris: ['./paper_data/TBCCDS/TBCCD1/TestDate/ProgramsDump/160362.c', './paper_data/TBCCDS/TBCCD1/TestDate/ProgramsMutate/160362.c', '1'] | m/680/4145620 | m/680/4145621 |
+------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+---------------+
| correct: 1 | predict: 1 clone_paris: ['./paper_data/TBCCDS/TBCCD1/TestDate/ProgramsDump/160363.c', './paper_data/TBCCDS/TBCCD1/TestDate/ProgramsMutate/160363.c', '1']  | m/680/4145630 | m/680/4145631 |
+------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+---------------+
| correct: 1 | predict: 1 clone_paris: ['./paper_data/TBCCDS/TBCCD1/TestDate/ProgramsDump/160364.c', './paper_data/TBCCDS/TBCCD1/TestDate/ProgramsMutate/160364.c', '1']  | m/680/4145640 | m/680/4145641 |
+------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+---------------+


Genetic Algorithm
^^^^^^^^^^^^^^^^^^^^
It is similar to the Random Mutation.

MCMC
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
It is similar to the Random Mutation.


Final Result 
-------------

.. table:: The Escape Rate of ML-based detectors
    :align: center   

    +------------+--------+--------+--------+--------+
    | Detector   | AM     | RM     | GA     | MCMC   |
    +------------+--------+--------+--------+--------+
    | ASTNN      | 92.30% | 86.56% | 95.14% | 93.69% |
    +------------+--------+--------+--------+--------+
    | TBCCD      | 40.60% | 37.38% | 29.47% | 17.25% |
    +------------+--------+--------+--------+--------+
    | FCDetector | 9.4%   | 16.78% | 21.43% | 19.92% |
    +------------+--------+--------+--------+--------+